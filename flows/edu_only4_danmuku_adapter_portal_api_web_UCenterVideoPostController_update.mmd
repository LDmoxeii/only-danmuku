flowchart TD
  N1[[EncryptHlsVariantWithKeyCliHandler]]
  class N1 clihandler
  N2[[GenerateEncryptedMasterByVariantsCliHandler]]
  class N2 clihandler
  N3[[GenerateVideoAbrMasterCliHandler]]
  class N3 clihandler
  N4[[MergeUploadToMp4ByPathCliHandler]]
  class N4 clihandler
  N5[[TranscodeVideoFileToAbrByPathCliHandler]]
  class N5 clihandler
  N6[[UploadVideoAbrOutputCliHandler]]
  class N6 clihandler
  N7[[GetVideoPostProcessingEncryptContextQryHandler]]
  class N7 queryhandler
  N8[[GetUploadSessionTempPathQryHandler]]
  class N8 queryhandler
  N9([UCenterVideoPostController::update])
  class N9 controllermethod
  N10[[GenerateVideoPostQualityKeyCmd.Handler]]
  class N10 commandhandler
  N11{{GenerateVideoPostQualityKeyCmd.Request}}
  class N11 command
  N12[[SyncVideoPostProcessStatusCmd.Handler]]
  class N12 commandhandler
  N13{{SyncVideoPostProcessStatusCmd.Request}}
  class N13 command
  N14[[UpdateVideoPostCmd.Handler]]
  class N14 commandhandler
  N15{{UpdateVideoPostCmd.Request}}
  class N15 command
  N16[[ApplyVideoPostProcessingEncryptResultCmd.Handler]]
  class N16 commandhandler
  N17{{ApplyVideoPostProcessingEncryptResultCmd.Request}}
  class N17 command
  N18[[ApplyVideoPostProcessingTranscodeResultCmd.Handler]]
  class N18 commandhandler
  N19{{ApplyVideoPostProcessingTranscodeResultCmd.Request}}
  class N19 command
  N20[[ApplyVideoPostProcessingVariantEncryptResultCmd.Handler]]
  class N20 commandhandler
  N21{{ApplyVideoPostProcessingVariantEncryptResultCmd.Request}}
  class N21 command
  N22[[PrepareVideoPostProcessingEncryptContextCmd.Handler]]
  class N22 commandhandler
  N23{{PrepareVideoPostProcessingEncryptContextCmd.Request}}
  class N23 command
  N24[[StartVideoPostProcessingCmd.Handler]]
  class N24 commandhandler
  N25{{StartVideoPostProcessingCmd.Request}}
  class N25 command
  N26{{EncryptHlsVariantWithKeyCli.Request}}
  class N26 cli
  N27{{GenerateEncryptedMasterByVariantsCli.Request}}
  class N27 cli
  N28{{GenerateVideoAbrMasterCli.Request}}
  class N28 cli
  N29{{MergeUploadToMp4ByPathCli.Request}}
  class N29 cli
  N30{{TranscodeVideoFileToAbrByPathCli.Request}}
  class N30 cli
  N31{{UploadVideoAbrOutputCli.Request}}
  class N31 cli
  N32{{GetVideoPostProcessingEncryptContextQry.Request}}
  class N32 query
  N33{{GetUploadSessionTempPathQry.Request}}
  class N33 query
  N34[[VideoPostQualityKeyGeneratedDomainEventSubscriber::on]]
  class N34 domaineventhandler
  N35[[VideoPostTranscodingRequestedDomainEventSubscriber::on]]
  class N35 domaineventhandler
  N36[[VideoPostProcessingCompletedDomainEventSubscriber::on]]
  class N36 domaineventhandler
  N37[[VideoPostProcessingEncryptContextPreparedDomainEventSubscriber::on]]
  class N37 domaineventhandler
  N38[[VideoPostProcessingFileEncryptCompletedDomainEventSubscriber::on]]
  class N38 domaineventhandler
  N39[[VideoPostProcessingStartedDomainEventSubscriber::on]]
  class N39 domaineventhandler
  N40[[VideoPostProcessingTranscodeCompletedDomainEventSubscriber::on]]
  class N40 domaineventhandler
  N41(VideoHlsEncryptKey::onCreate)
  class N41 entitymethod
  N42((VideoHlsEncryptKeyCreatedDomainEvent))
  class N42 domainevent
  N43(VideoFilePost::&lt;get-fileIndex&gt;)
  class N43 entitymethod
  N44(VideoFilePost::&lt;get-uploadId&gt;)
  class N44 entitymethod
  N45(VideoFilePost::applyEncryptResult)
  class N45 entitymethod
  N46(VideoFilePost::applyTranscodeResult)
  class N46 entitymethod
  N47(VideoFilePost::syncVariants)
  class N47 entitymethod
  N48(VideoPost::&lt;get-customerId&gt;)
  class N48 entitymethod
  N49(VideoPost::&lt;get-id&gt;)
  class N49 entitymethod
  N50(VideoPost::&lt;get-videoFilePosts&gt;)
  class N50 entitymethod
  N51(VideoPost::applyBasicInfo)
  class N51 entitymethod
  N52(VideoPost::applyProcessStatus)
  class N52 entitymethod
  N53(VideoPost::markPendingReview)
  class N53 entitymethod
  N54(VideoPost::markTranscoding)
  class N54 entitymethod
  N55(VideoPost::updateDuration)
  class N55 entitymethod
  N56((VideoPostTranscodingRequestedDomainEvent))
  class N56 domainevent
  N57(VideoPostProcessing::&lt;get-videoPostProcessingFiles&gt;)
  class N57 entitymethod
  N58(VideoPostProcessing::appendFiles)
  class N58 entitymethod
  N59(VideoPostProcessing::applyEncryptResult)
  class N59 entitymethod
  N60(VideoPostProcessing::applyTranscodeResult)
  class N60 entitymethod
  N61(VideoPostProcessing::applyVariantEncryptResult)
  class N61 entitymethod
  N62(VideoPostProcessing::onCreate)
  class N62 entitymethod
  N63(VideoPostProcessing::prepareEncryptContext)
  class N63 entitymethod
  N64(VideoPostProcessingFile::&lt;get-encryptKeyVersion&gt;)
  class N64 entitymethod
  N65(VideoPostProcessingFile::&lt;get-fileIndex&gt;)
  class N65 entitymethod
  N66((VideoPostProcessingCompletedDomainEvent))
  class N66 domainevent
  N67((VideoPostProcessingEncryptContextPreparedDomainEvent))
  class N67 domainevent
  N68((VideoPostProcessingFileEncryptCompletedDomainEvent))
  class N68 domainevent
  N69((VideoPostProcessingStartedDomainEvent))
  class N69 domainevent
  N70((VideoPostProcessingTranscodeCompletedDomainEvent))
  class N70 domainevent
  N9 -->|ControllerMethodToCommand| N15
  N10 -->|CommandHandlerToEntityMethod| N41
  N11 -->|CommandToCommandHandler| N10
  N12 -->|CommandHandlerToEntityMethod| N43
  N12 -->|CommandHandlerToEntityMethod| N45
  N12 -->|CommandHandlerToEntityMethod| N46
  N12 -->|CommandHandlerToEntityMethod| N47
  N12 -->|CommandHandlerToEntityMethod| N50
  N12 -->|CommandHandlerToEntityMethod| N52
  N12 -->|CommandHandlerToEntityMethod| N55
  N13 -->|CommandToCommandHandler| N12
  N14 -->|CommandHandlerToEntityMethod| N43
  N14 -->|CommandHandlerToEntityMethod| N44
  N14 -->|CommandHandlerToEntityMethod| N48
  N14 -->|CommandHandlerToEntityMethod| N49
  N14 -->|CommandHandlerToEntityMethod| N50
  N14 -->|CommandHandlerToEntityMethod| N51
  N14 -->|CommandHandlerToEntityMethod| N53
  N14 -->|CommandHandlerToEntityMethod| N54
  N15 -->|CommandToCommandHandler| N14
  N16 -->|CommandHandlerToEntityMethod| N59
  N17 -->|CommandToCommandHandler| N16
  N18 -->|CommandHandlerToEntityMethod| N60
  N19 -->|CommandToCommandHandler| N18
  N20 -->|CommandHandlerToEntityMethod| N61
  N21 -->|CommandToCommandHandler| N20
  N22 -->|CommandHandlerToEntityMethod| N57
  N22 -->|CommandHandlerToEntityMethod| N63
  N22 -->|CommandHandlerToEntityMethod| N64
  N22 -->|CommandHandlerToEntityMethod| N65
  N23 -->|CommandToCommandHandler| N22
  N24 -->|CommandHandlerToEntityMethod| N58
  N24 -->|CommandHandlerToEntityMethod| N62
  N25 -->|CommandToCommandHandler| N24
  N26 -->|CliToCliHandler| N1
  N27 -->|CliToCliHandler| N2
  N28 -->|CliToCliHandler| N3
  N29 -->|CliToCliHandler| N4
  N30 -->|CliToCliHandler| N5
  N31 -->|CliToCliHandler| N6
  N32 -->|QueryToQueryHandler| N7
  N33 -->|QueryToQueryHandler| N8
  N34 -->|DomainEventHandlerToCommand| N21
  N34 -->|DomainEventHandlerToCli| N26
  N34 -->|DomainEventHandlerToQuery| N32
  N35 -->|DomainEventHandlerToCommand| N25
  N36 -->|DomainEventHandlerToCommand| N13
  N37 -->|DomainEventHandlerToCommand| N11
  N37 -->|DomainEventHandlerToCommand| N17
  N38 -->|DomainEventHandlerToCommand| N17
  N38 -->|DomainEventHandlerToCli| N27
  N38 -->|DomainEventHandlerToQuery| N32
  N39 -->|DomainEventHandlerToCommand| N19
  N39 -->|DomainEventHandlerToCli| N28
  N39 -->|DomainEventHandlerToCli| N29
  N39 -->|DomainEventHandlerToCli| N30
  N39 -->|DomainEventHandlerToCli| N31
  N39 -->|DomainEventHandlerToQuery| N33
  N40 -->|DomainEventHandlerToCommand| N23
  N41 -->|EntityMethodToDomainEvent| N42
  N42 -->|DomainEventToHandler| N34
  N54 -->|EntityMethodToDomainEvent| N56
  N56 -->|DomainEventToHandler| N35
  N58 -->|EntityMethodToDomainEvent| N69
  N59 -->|EntityMethodToDomainEvent| N66
  N60 -->|EntityMethodToDomainEvent| N70
  N61 -->|EntityMethodToDomainEvent| N68
  N63 -->|EntityMethodToDomainEvent| N67
  N66 -->|DomainEventToHandler| N36
  N67 -->|DomainEventToHandler| N37
  N68 -->|DomainEventToHandler| N38
  N69 -->|DomainEventToHandler| N39
  N70 -->|DomainEventToHandler| N40
  classDef cli fill:#86EFAC,stroke:#15803D,color:#0F172A
  classDef clihandler fill:#22C55E,stroke:#166534,color:#F0FDF4
  classDef command fill:#FDBA74,stroke:#C2410C,color:#111827
  classDef commandhandler fill:#F97316,stroke:#9A3412,color:#111827
  classDef controllermethod fill:#FDE68A,stroke:#B45309,color:#111827
  classDef domainevent fill:#FECACA,stroke:#B91C1C,color:#111827
  classDef domaineventhandler fill:#F87171,stroke:#991B1B,color:#111827
  classDef entitymethod fill:#F3F4F6,stroke:#6B7280,color:#111827
  classDef query fill:#93C5FD,stroke:#1D4ED8,color:#0F172A
  classDef queryhandler fill:#3B82F6,stroke:#1E40AF,color:#F8FAFC
